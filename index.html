<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Gantt≈Øv diagram - BTR Nov√© Dvory</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        :root {
            --primary: #1f4e79;
            --primary-light: #2e75b6;
            --phase-0: #c5e0b4;
            --phase-0A: #a8d08d;
            --phase-1: #bdd7ee;
            --phase-1A: #9bc2e6;
            --phase-2: #ffe699;
            --phase-3: #f8cbad;
            --phase-4: #d9d2e9;
        }
        
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; 
            background: #f5f5f5; 
            min-height: 100vh;
        }
        
        .container { 
            max-width: 1600px; 
            margin: 0 auto; 
            background: white; 
            box-shadow: 0 2px 10px rgba(0,0,0,0.1); 
        }
        
        /* Header */
        h1 { 
            text-align: center; 
            padding: 15px 10px; 
            background: var(--primary); 
            color: white; 
            font-size: clamp(14px, 4vw, 22px);
        }
        
        .subtitle { 
            text-align: center; 
            padding: 8px; 
            background: var(--primary-light); 
            color: white; 
            font-size: clamp(10px, 2.5vw, 14px);
        }
        
        /* Controls */
        .controls { 
            padding: 10px; 
            background: #f8f9fa; 
            border-bottom: 1px solid #ddd; 
            display: flex; 
            gap: 10px 20px; 
            justify-content: center; 
            flex-wrap: wrap;
            align-items: center;
        }
        
        .controls label { 
            display: flex; 
            align-items: center; 
            gap: 6px; 
            font-size: 13px;
            cursor: pointer;
        }
        
        .controls select { 
            padding: 6px 10px; 
            border-radius: 4px; 
            border: 1px solid #ccc;
            font-size: 13px;
            background: white;
        }
        
        .controls input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }
        
        /* Legend */
        .legend { 
            display: flex; 
            gap: 8px 15px; 
            padding: 8px 10px; 
            background: #fff; 
            border-bottom: 1px solid #ddd; 
            flex-wrap: wrap; 
            justify-content: center; 
            font-size: 11px;
        }
        
        .legend-item { 
            display: flex; 
            align-items: center; 
            gap: 4px;
            white-space: nowrap;
        }
        
        .legend-color { 
            width: 16px; 
            height: 10px; 
            border-radius: 2px;
            flex-shrink: 0;
        }
        
        /* View toggle for mobile */
        .view-toggle {
            display: none;
            width: 100%;
            padding: 10px;
            background: #e9ecef;
            border-bottom: 1px solid #ddd;
        }
        
        .view-toggle button {
            flex: 1;
            padding: 10px;
            border: none;
            background: white;
            font-size: 13px;
            cursor: pointer;
            border-radius: 4px;
            margin: 0 5px;
        }
        
        .view-toggle button.active {
            background: var(--primary);
            color: white;
        }
        
        /* Chart wrapper */
        .chart-wrapper {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }
        
        .chart-container {
            min-width: 900px;
        }
        
        /* Chart header */
        .chart-header { 
            display: flex; 
            background: var(--primary); 
            color: white; 
            font-weight: bold; 
            font-size: 12px;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        
        .chart-header .col-code { 
            width: 50px; 
            min-width: 50px; 
            padding: 8px 4px; 
            border-right: 1px solid #3d7ab5;
            text-align: center;
        }
        
        .chart-header .col-name { 
            width: 180px; 
            min-width: 180px; 
            padding: 8px; 
            border-right: 1px solid #3d7ab5;
        }
        
        .chart-header .col-resp {
            width: 90px;
            min-width: 90px;
            padding: 8px 4px;
            border-right: 1px solid #3d7ab5;
            text-align: center;
        }
        
        .chart-header .timeline-col { 
            flex: 1; 
            display: flex; 
            position: relative;
            min-width: 500px;
        }
        
        .year-marker { 
            flex: 1; 
            text-align: center; 
            padding: 8px; 
            border-right: 1px solid #3d7ab5;
        }
        
        /* Quarter row */
        .quarter-row { 
            display: flex; 
            background: #e9ecef; 
            font-size: 10px; 
            color: #666;
            position: sticky;
            top: 34px;
            z-index: 9;
        }
        
        .quarter-row .col-code,
        .quarter-row .col-name,
        .quarter-row .col-resp { 
            background: #d9d9d9;
            border-right: 1px solid #ccc;
        }
        
        .quarter-row .col-code { width: 50px; min-width: 50px; padding: 4px; text-align: center; font-weight: bold; }
        .quarter-row .col-name { width: 180px; min-width: 180px; padding: 4px 8px; font-weight: bold; }
        .quarter-row .col-resp { width: 90px; min-width: 90px; padding: 4px; text-align: center; font-weight: bold; }
        .quarter-row .timeline-col { flex: 1; position: relative; height: 22px; min-width: 500px; }
        
        .quarter-marker { 
            position: absolute; 
            top: 0; 
            height: 100%; 
            border-left: 1px solid #bbb; 
            padding-left: 3px; 
            font-size: 9px;
            display: flex;
            align-items: center;
        }
        
        /* Chart body */
        .chart-body { 
            max-height: 60vh; 
            overflow-y: auto;
        }
        
        .activity-row { 
            display: flex; 
            border-bottom: 1px solid #eee;
            transition: background 0.15s;
        }
        
        .activity-row:nth-child(even) { background: #fafafa; }
        .activity-row:hover { background: #e8f4fc; }
        
        .activity-row .col-code {
            width: 50px;
            min-width: 50px;
            padding: 5px 4px;
            border-right: 1px solid #eee;
            font-family: monospace;
            font-weight: bold;
            font-size: 11px;
            color: var(--primary);
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .activity-row .col-name { 
            width: 180px; 
            min-width: 180px; 
            padding: 5px 8px; 
            border-right: 1px solid #eee; 
            font-size: 11px;
            display: flex;
            align-items: center;
        }
        
        .activity-row .col-resp {
            width: 90px;
            min-width: 90px;
            padding: 5px 4px;
            border-right: 1px solid #eee;
            font-size: 10px;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #555;
            font-weight: 500;
        }
        
        .activity-name { 
            white-space: nowrap; 
            overflow: hidden; 
            text-overflow: ellipsis;
        }
        
        .timeline-col { 
            flex: 1; 
            position: relative; 
            height: 28px;
            min-width: 500px;
        }
        
        .grid-line { 
            position: absolute; 
            top: 0; 
            height: 100%; 
            border-left: 1px solid #f0f0f0;
        }
        
        .bar { 
            position: absolute; 
            top: 4px; 
            height: 20px; 
            border-radius: 3px; 
            display: flex; 
            align-items: center; 
            padding: 0 4px; 
            font-size: 9px; 
            font-weight: bold; 
            color: #333; 
            cursor: pointer; 
            transition: transform 0.1s, box-shadow 0.1s;
            min-width: 4px;
        }
        
        .bar:hover { 
            transform: scaleY(1.15); 
            box-shadow: 0 2px 8px rgba(0,0,0,0.25); 
            z-index: 10;
        }
        
        .bar.critical { box-shadow: inset 0 0 0 1px rgba(0,0,0,0.1); }
        .bar.non-critical { opacity: 0.45; }
        .bar.risk { border: 2px solid #dc3545; }
        
        .milestone { 
            position: absolute; 
            top: 50%; 
            transform: translateY(-50%) rotate(45deg); 
            width: 10px; 
            height: 10px; 
            background: #6f42c1; 
            border: 2px solid #4a2c82;
        }
        
        .phase-0 { background: var(--phase-0); }
        .phase-0A { background: var(--phase-0A); }
        .phase-1 { background: var(--phase-1); }
        .phase-1A { background: var(--phase-1A); }
        .phase-2 { background: var(--phase-2); }
        .phase-3 { background: var(--phase-3); }
        .phase-4 { background: var(--phase-4); }
        
        /* Summary cards */
        .summary { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); 
            gap: 12px; 
            padding: 15px; 
            background: #f8f9fa;
        }
        
        .summary-card { 
            background: white; 
            padding: 12px; 
            border-radius: 8px; 
            border-left: 4px solid;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .summary-card.blue { border-color: #2e75b6; }
        .summary-card.red { border-color: #dc3545; }
        .summary-card.green { border-color: #28a745; }
        
        .summary-card h3 { 
            font-size: 13px; 
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .summary-card p { font-size: 12px; color: #555; }
        .summary-card ul { font-size: 11px; padding-left: 16px; color: #555; }
        .summary-card li { margin: 3px 0; }
        
        /* Mobile list view */
        .mobile-list {
            display: none;
        }
        
        .mobile-card {
            padding: 12px;
            border-bottom: 1px solid #eee;
            background: white;
        }
        
        .mobile-card:nth-child(even) {
            background: #fafafa;
        }
        
        .mobile-card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 8px;
        }
        
        .mobile-card-code {
            font-family: monospace;
            font-weight: bold;
            color: var(--primary);
            font-size: 13px;
        }
        
        .mobile-card-resp {
            font-size: 11px;
            color: #666;
            background: #f0f0f0;
            padding: 2px 8px;
            border-radius: 10px;
        }
        
        .mobile-card-name {
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 8px;
        }
        
        .mobile-card-bar {
            height: 24px;
            border-radius: 4px;
            position: relative;
            background: #e9ecef;
            overflow: hidden;
        }
        
        .mobile-card-progress {
            height: 100%;
            border-radius: 4px;
            display: flex;
            align-items: center;
            padding: 0 8px;
            font-size: 10px;
            color: #333;
            font-weight: 500;
        }
        
        .mobile-card-dates {
            display: flex;
            justify-content: space-between;
            font-size: 10px;
            color: #888;
            margin-top: 4px;
        }
        
        .mobile-card.non-critical {
            opacity: 0.6;
        }
        
        .mobile-card.risk .mobile-card-progress {
            border: 2px solid #dc3545;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .view-toggle {
                display: flex;
            }
            
            .chart-wrapper.hide-mobile {
                display: none;
            }
            
            .mobile-list.show-mobile {
                display: block;
            }
            
            .legend {
                font-size: 10px;
                gap: 5px 10px;
            }
            
            .legend-color {
                width: 12px;
                height: 8px;
            }
            
            .summary {
                grid-template-columns: 1fr;
            }
            
            .controls {
                gap: 8px 15px;
            }
            
            .controls label {
                font-size: 12px;
            }
        }
        
        @media (max-width: 480px) {
            h1 {
                padding: 12px 8px;
            }
            
            .subtitle {
                padding: 6px;
            }
            
            .legend-item span {
                display: none;
            }
            
            .legend-item::after {
                content: attr(data-short);
                font-size: 9px;
            }
        }
        
        /* Print */
        @media print {
            .controls, .view-toggle, .mobile-list { display: none !important; }
            .chart-wrapper { display: block !important; }
            .chart-body { max-height: none; overflow: visible; }
            .summary { break-inside: avoid; }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>GANTT≈ÆV DIAGRAM ‚Äì BTR Nov√© Dvory</h1>
        <div class="subtitle">Kritick√° cesta: 189 t√Ωdn≈Ø (43 mƒõs√≠c≈Ø) | 1.1.2026 ‚Üí 17.8.2029</div>
        
        <div class="controls">
            <label>
                F√°ze:
                <select id="phaseFilter">
                    <option value="all">V≈°echny f√°ze</option>
                    <option value="0">0: P≈ô√≠prava</option>
                    <option value="0A">0A: Financov√°n√≠ I</option>
                    <option value="1">1: Projektov√° p≈ô√≠prava</option>
                    <option value="1A">1A: Financov√°n√≠ II</option>
                    <option value="2">2: V√Ωbƒõr dodavatele</option>
                    <option value="3">3: Realizace</option>
                    <option value="4">4: Provoz</option>
                </select>
            </label>
            <label>
                Role:
                <select id="roleFilter">
                    <option value="all">V≈°echny role</option>
                    <option value="INV">INV - Investor</option>
                    <option value="PM">PM - Projektov√Ω mana≈æer</option>
                    <option value="ARCH">ARCH - Architekt</option>
                    <option value="PROJ">PROJ - Projektant</option>
                    <option value="EKO">EKO - Ekonom</option>
                    <option value="ING">ING - In≈æen√Ωring</option>
                    <option value="LEG">LEG - Legal</option>
                    <option value="GD">GD - Gener√°ln√≠ dodavatel</option>
                    <option value="TDI">TDI - Technick√Ω dozor</option>
                    <option value="MKT">MKT - Marketing</option>
                    <option value="FM">FM - Facility manager</option>
                    <option value="GEO">GEO - Geolog</option>
                    <option value="√ö≈òAD">√ö≈òAD - Stavebn√≠ √∫≈ôad</option>
                </select>
            </label>
            <label>
                <input type="checkbox" id="criticalOnly">
                Pouze kritick√° cesta
            </label>
        </div>

        <div class="legend">
            <div class="legend-item" data-short="0"><div class="legend-color phase-0"></div><span>0: P≈ô√≠prava</span></div>
            <div class="legend-item" data-short="0A"><div class="legend-color phase-0A"></div><span>0A: Fin.I</span></div>
            <div class="legend-item" data-short="1"><div class="legend-color phase-1"></div><span>1: Projekt</span></div>
            <div class="legend-item" data-short="1A"><div class="legend-color phase-1A"></div><span>1A: Fin.II</span></div>
            <div class="legend-item" data-short="2"><div class="legend-color phase-2"></div><span>2: V√Ωbƒõr</span></div>
            <div class="legend-item" data-short="3"><div class="legend-color phase-3"></div><span>3: Realizace</span></div>
            <div class="legend-item" data-short="4"><div class="legend-color phase-4"></div><span>4: Provoz</span></div>
            <div class="legend-item" data-short="‚ö†Ô∏è"><div class="legend-color" style="border: 2px solid #dc3545; background: #ffe6e6;"></div><span>Riziko</span></div>
        </div>

        <!-- Mobile view toggle -->
        <div class="view-toggle">
            <button id="btnList" class="active">Seznam</button>
            <button id="btnGantt">Gantt</button>
        </div>

        <!-- Desktop Gantt Chart -->
        <div class="chart-wrapper hide-mobile" id="chartWrapper">
            <div class="chart-container">
                <div class="chart-header">
                    <div class="col-code">K√≥d</div>
                    <div class="col-name">Aktivita</div>
                    <div class="col-resp">Odpovƒõdnost</div>
                    <div class="timeline-col">
                        <div class="year-marker">2026</div>
                        <div class="year-marker">2027</div>
                        <div class="year-marker">2028</div>
                        <div class="year-marker">2029</div>
                    </div>
                </div>

                <div class="quarter-row">
                    <div class="col-code">#</div>
                    <div class="col-name">N√°zev</div>
                    <div class="col-resp">Role</div>
                    <div class="timeline-col" id="quarterMarkers"></div>
                </div>

                <div class="chart-body" id="chartBody"></div>
            </div>
        </div>

        <!-- Mobile List View -->
        <div class="mobile-list" id="mobileList"></div>

        <div class="summary">
            <div class="summary-card blue">
                <h3>üìä Kritick√° cesta</h3>
                <p>29 aktivit bez ƒçasov√© rezervy</p>
                <p style="font-size: 10px; color: #888; margin-top: 5px;">Jak√©koliv zpo≈ædƒõn√≠ = zpo≈ædƒõn√≠ projektu</p>
            </div>
            <div class="summary-card red">
                <h3>‚ö†Ô∏è Nejvy≈°≈°√≠ riziko</h3>
                <ul>
                    <li><strong>3.5</strong> Hrub√° stavba (22 t√Ωdn≈Ø)</li>
                    <li><strong>3.7</strong> TZB instalace (13 t√Ωdn≈Ø)</li>
                    <li><strong>1.3+1.4</strong> Povolen√≠ (24 t√Ωdn≈Ø)</li>
                </ul>
            </div>
            <div class="summary-card green">
                <h3>‚úì S rezervou</h3>
                <ul>
                    <li>Financov√°n√≠ (paralelnƒõ)</li>
                    <li>Pre-leasing (paralelnƒõ)</li>
                    <li>FM nastaven√≠ (paralelnƒõ)</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        const projectStart = new Date(2026, 0, 1);
        const projectEnd = new Date(2029, 7, 31);
        const totalDays = Math.ceil((projectEnd - projectStart) / (1000 * 60 * 60 * 24));

        const activities = [
            { code: '0.1', name: 'Anal√Ωza √∫zem√≠ a regulativ≈Ø', start: '2026-01-01', end: '2026-01-29', phase: '0', critical: true, resp: 'PM, ARCH' },
            { code: '0.2', name: 'Anal√Ωza trhu', start: '2026-01-01', end: '2026-01-22', phase: '0', critical: false, resp: 'INV, PM' },
            { code: '0.3', name: 'SWOT projektu', start: '2026-01-01', end: '2026-01-08', phase: '0', critical: false, resp: 'PM' },
            { code: '0.4', name: 'Identifikace rizik', start: '2026-01-01', end: '2026-01-08', phase: '0', critical: false, resp: 'INV, PM' },
            { code: '0.5', name: 'Ekonomick√© posouzen√≠', start: '2026-01-01', end: '2026-01-15', phase: '0', critical: false, resp: 'INV, EKO' },
            { code: '0.6', name: 'Geologick√Ω pr≈Øzkum', start: '2026-01-15', end: '2026-02-05', phase: '0', critical: false, resp: 'GEO, PM' },
            { code: '0A.1', name: 'P≈ôedjedn√°n√≠ financov√°n√≠', start: '2026-01-29', end: '2026-04-09', phase: '0A', critical: false, resp: 'INV, EKO' },
            { code: '0A.2', name: 'Aktualizace fin. modelu', start: '2026-04-09', end: '2026-05-07', phase: '0A', critical: false, resp: 'INV, EKO' },
            { code: '0A.3', name: 'Nez√°vazn√© nab√≠dky bank', start: '2026-05-07', end: '2026-06-11', phase: '0A', critical: false, resp: 'INV, EKO' },
            { code: '1.1', name: 'Architektonick√° studie', start: '2026-01-29', end: '2026-03-19', phase: '1', critical: true, resp: 'ARCH' },
            { code: '1.2', name: 'Konzultace se stav. √∫≈ôadem', start: '2026-03-19', end: '2026-04-16', phase: '1', critical: true, resp: 'ARCH, ING' },
            { code: '1.3', name: 'DPZ (vƒç. DOSS)', start: '2026-04-16', end: '2026-07-09', phase: '1', critical: true, risk: true, resp: 'ARCH, PROJ' },
            { code: '1.4', name: '≈ò√≠zen√≠ o povolen√≠ z√°mƒõru', start: '2026-07-09', end: '2026-10-01', phase: '1', critical: true, risk: true, resp: 'ING, √ö≈òAD' },
            { code: '1.5', name: 'Buffer ‚Äì odvolac√≠ lh≈Øta', start: '2026-10-01', end: '2026-10-29', phase: '1', critical: true, resp: '√ö≈òAD' },
            { code: '1.6', name: 'Value engineering', start: '2026-10-29', end: '2026-11-26', phase: '1', critical: true, resp: 'PM, ARCH, EKO' },
            { code: '1.7', name: 'PDPS', start: '2026-11-26', end: '2027-02-18', phase: '1', critical: true, resp: 'PROJ' },
            { code: '1A.1', name: 'DD banky', start: '2026-11-26', end: '2027-01-07', phase: '1A', critical: false, resp: 'INV, EKO' },
            { code: '1A.2', name: 'Vyjedn√°n√≠ √∫vƒõru', start: '2027-01-07', end: '2027-02-18', phase: '1A', critical: false, resp: 'INV, EKO' },
            { code: '1A.3', name: 'Podpis √∫vƒõrov√© smlouvy', start: '2027-02-18', end: '2027-03-04', phase: '1A', critical: false, resp: 'INV, EKO' },
            { code: '2.1', name: 'Popt√°vkov√© ≈ô√≠zen√≠ GD', start: '2027-02-18', end: '2027-03-18', phase: '2', critical: true, resp: 'PM' },
            { code: '2.2', name: 'Vyhodnocen√≠ a vyjedn√°v√°n√≠', start: '2027-03-18', end: '2027-04-08', phase: '2', critical: true, resp: 'INV, PM' },
            { code: '2.3', name: 'Smlouva o d√≠lo', start: '2027-04-08', end: '2027-04-22', phase: '2', critical: true, resp: 'INV, LEG' },
            { code: '2.4', name: 'Poji≈°tƒõn√≠ stavby', start: '2027-04-22', end: '2027-04-29', phase: '2', critical: true, resp: 'INV, LEG' },
            { code: '3.1', name: 'Za≈ô√≠zen√≠ staveni≈°tƒõ', start: '2027-04-29', end: '2027-05-13', phase: '3', critical: true, resp: 'GD' },
            { code: '3.2', name: 'Zemn√≠ pr√°ce', start: '2027-05-13', end: '2027-06-17', phase: '3', critical: true, resp: 'GD, TDI' },
            { code: '3.3', name: 'Z√°klady', start: '2027-06-17', end: '2027-07-15', phase: '3', critical: true, resp: 'GD, TDI' },
            { code: '3.4', name: 'Suter√©n', start: '2027-07-15', end: '2027-08-26', phase: '3', critical: true, resp: 'GD, TDI' },
            { code: '3.5', name: 'Hrub√° stavba NP', start: '2027-08-26', end: '2028-01-27', phase: '3', critical: true, risk: true, resp: 'GD, TDI' },
            { code: '3.6', name: 'St≈ôecha a fas√°da', start: '2028-01-27', end: '2028-03-30', phase: '3', critical: true, resp: 'GD, TDI' },
            { code: '3.7', name: 'Instalace TZB', start: '2028-03-30', end: '2028-06-29', phase: '3', critical: true, risk: true, resp: 'GD, PROJ' },
            { code: '3.8', name: 'Okna, v√Ωplnƒõ', start: '2028-06-29', end: '2028-07-27', phase: '3', critical: true, resp: 'GD, TDI' },
            { code: '3.9', name: 'Om√≠tky, SDK', start: '2028-07-27', end: '2028-09-07', phase: '3', critical: true, resp: 'GD, TDI' },
            { code: '3.10', name: 'Podlahy, dla≈æby', start: '2028-09-07', end: '2028-10-05', phase: '3', critical: true, resp: 'GD, TDI' },
            { code: '3.11', name: 'Interi√©ry', start: '2028-10-05', end: '2028-11-16', phase: '3', critical: true, resp: 'GD, TDI' },
            { code: '3.12', name: 'Revize a zkou≈°ky', start: '2028-11-16', end: '2028-12-07', phase: '3', critical: true, resp: 'GD, TDI' },
            { code: '3.13', name: 'Kolaudace', start: '2028-12-07', end: '2029-01-11', phase: '3', critical: true, resp: 'GD, ING' },
            { code: '3.14', name: 'P≈ôed√°n√≠ stavby', start: '2029-01-11', end: '2029-01-25', phase: '3', critical: true, resp: 'GD, PM' },
            { code: '4.1', name: 'Pre-leasing', start: '2028-10-05', end: '2028-12-28', phase: '4', critical: false, resp: 'MKT' },
            { code: '4.2', name: 'Nastaven√≠ FM', start: '2028-12-07', end: '2029-01-04', phase: '4', critical: false, resp: 'FM, PM' },
            { code: '4.3', name: 'P≈ôed√°n√≠ n√°jemn√≠k≈Øm', start: '2029-01-25', end: '2029-02-22', phase: '4', critical: true, resp: 'FM, MKT' },
            { code: '4.4', name: 'Stabilizace provozu', start: '2029-02-22', end: '2029-05-17', phase: '4', critical: true, resp: 'FM, INV' },
            { code: '4.5', name: '50% obsazenost', start: '2029-05-17', end: '2029-05-17', phase: '4', critical: true, milestone: true, resp: '‚Äî' },
            { code: '4.6', name: '95% obsazenost', start: '2029-05-17', end: '2029-08-17', phase: '4', critical: true, resp: 'MKT, INV' },
        ];

        const phaseColors = {
            '0': 'phase-0', '0A': 'phase-0A', '1': 'phase-1', '1A': 'phase-1A',
            '2': 'phase-2', '3': 'phase-3', '4': 'phase-4'
        };

        function getPosition(dateStr) {
            const date = new Date(dateStr);
            const days = Math.ceil((date - projectStart) / (1000 * 60 * 60 * 24));
            return (days / totalDays) * 100;
        }

        function getWidth(start, end) {
            const s = new Date(start);
            const e = new Date(end);
            const days = Math.ceil((e - s) / (1000 * 60 * 60 * 24));
            return Math.max((days / totalDays) * 100, 0.5);
        }

        function formatDate(dateStr) {
            const d = new Date(dateStr);
            return d.toLocaleDateString('cs-CZ', { day: 'numeric', month: 'numeric', year: 'numeric' });
        }

        function formatDateShort(dateStr) {
            const d = new Date(dateStr);
            return d.toLocaleDateString('cs-CZ', { day: 'numeric', month: 'numeric' });
        }

        // Generate quarter markers
        function generateQuarterMarkers() {
            const container = document.getElementById('quarterMarkers');
            const quarters = ['Q1', 'Q2', 'Q3', 'Q4'];
            let html = '';
            
            for (let year = 2026; year <= 2029; year++) {
                for (let q = 0; q < 4; q++) {
                    const date = new Date(year, q * 3, 1);
                    if (date <= projectEnd) {
                        const pos = getPosition(date.toISOString().split('T')[0]);
                        html += `<div class="quarter-marker" style="left: ${pos}%">${quarters[q]}</div>`;
                    }
                }
            }
            container.innerHTML = html;
        }

        // Generate grid lines
        function generateGridLines() {
            let html = '';
            for (let year = 2026; year <= 2029; year++) {
                for (let q = 0; q < 4; q++) {
                    const date = new Date(year, q * 3, 1);
                    if (date <= projectEnd) {
                        html += `<div class="grid-line" style="left: ${getPosition(date.toISOString().split('T')[0])}%"></div>`;
                    }
                }
            }
            return html;
        }

        // Render desktop Gantt chart
        function renderChart() {
            const phaseFilter = document.getElementById('phaseFilter').value;
            const roleFilter = document.getElementById('roleFilter').value;
            const criticalOnly = document.getElementById('criticalOnly').checked;
            const container = document.getElementById('chartBody');
            const gridLines = generateGridLines();
            
            let html = '';
            
            const filteredActivities = activities.filter(act => {
                if (criticalOnly && !act.critical) return false;
                if (phaseFilter !== 'all' && act.phase !== phaseFilter) return false;
                if (roleFilter !== 'all' && !act.resp.includes(roleFilter)) return false;
                return true;
            });

            filteredActivities.forEach((act) => {
                const barClasses = [
                    'bar',
                    phaseColors[act.phase] || '',
                    act.critical ? 'critical' : 'non-critical',
                    act.risk ? 'risk' : ''
                ].filter(Boolean).join(' ');

                const tooltip = `${act.code}: ${act.name}\n${formatDate(act.start)} ‚Üí ${formatDate(act.end)}\nOdpovƒõdnost: ${act.resp}${act.critical ? '\n‚òÖ Kritick√° cesta' : ''}`;

                html += `
                    <div class="activity-row">
                        <div class="col-code">${act.code}</div>
                        <div class="col-name">
                            <span class="activity-name" title="${act.name}">${act.name}</span>
                        </div>
                        <div class="col-resp">${act.resp}</div>
                        <div class="timeline-col">
                            ${gridLines}
                            ${act.milestone 
                                ? `<div class="milestone" style="left: ${getPosition(act.start)}%" title="${tooltip}"></div>`
                                : `<div class="${barClasses}" style="left: ${getPosition(act.start)}%; width: ${getWidth(act.start, act.end)}%;" title="${tooltip}">${getWidth(act.start, act.end) > 2.5 ? act.code : ''}</div>`
                            }
                        </div>
                    </div>
                `;
            });

            // Show message if no results
            if (filteredActivities.length === 0) {
                html = '<div style="padding: 20px; text-align: center; color: #666;">≈Ω√°dn√© aktivity neodpov√≠daj√≠ zvolen√Ωm filtr≈Øm.</div>';
            }

            container.innerHTML = html;
        }

        // Render mobile list view
        function renderMobileList() {
            const phaseFilter = document.getElementById('phaseFilter').value;
            const roleFilter = document.getElementById('roleFilter').value;
            const criticalOnly = document.getElementById('criticalOnly').checked;
            const container = document.getElementById('mobileList');
            
            const filteredActivities = activities.filter(act => {
                if (criticalOnly && !act.critical) return false;
                if (phaseFilter !== 'all' && act.phase !== phaseFilter) return false;
                if (roleFilter !== 'all' && !act.resp.includes(roleFilter)) return false;
                return true;
            });

            let html = '';
            
            filteredActivities.forEach(act => {
                const cardClasses = [
                    'mobile-card',
                    !act.critical ? 'non-critical' : '',
                    act.risk ? 'risk' : ''
                ].filter(Boolean).join(' ');

                const progressWidth = getWidth(act.start, act.end);
                const progressLeft = getPosition(act.start);

                html += `
                    <div class="${cardClasses}">
                        <div class="mobile-card-header">
                            <span class="mobile-card-code">${act.code}</span>
                            <span class="mobile-card-resp">${act.resp}</span>
                        </div>
                        <div class="mobile-card-name">${act.name}</div>
                        <div class="mobile-card-bar">
                            <div class="mobile-card-progress ${phaseColors[act.phase]}" 
                                 style="margin-left: ${progressLeft}%; width: ${Math.max(progressWidth, 5)}%;">
                                ${act.critical ? '‚òÖ' : ''}
                            </div>
                        </div>
                        <div class="mobile-card-dates">
                            <span>${formatDateShort(act.start)}</span>
                            <span>${formatDateShort(act.end)}</span>
                        </div>
                    </div>
                `;
            });

            // Show message if no results
            if (filteredActivities.length === 0) {
                html = '<div style="padding: 20px; text-align: center; color: #666;">≈Ω√°dn√© aktivity neodpov√≠daj√≠ zvolen√Ωm filtr≈Øm.</div>';
            }

            container.innerHTML = html;
        }

        // Render all
        function renderAll() {
            renderChart();
            renderMobileList();
        }

        // View toggle for mobile
        function setupViewToggle() {
            const btnList = document.getElementById('btnList');
            const btnGantt = document.getElementById('btnGantt');
            const chartWrapper = document.getElementById('chartWrapper');
            const mobileList = document.getElementById('mobileList');

            btnList.addEventListener('click', () => {
                btnList.classList.add('active');
                btnGantt.classList.remove('active');
                chartWrapper.classList.add('hide-mobile');
                mobileList.classList.add('show-mobile');
            });

            btnGantt.addEventListener('click', () => {
                btnGantt.classList.add('active');
                btnList.classList.remove('active');
                chartWrapper.classList.remove('hide-mobile');
                mobileList.classList.remove('show-mobile');
            });
        }

        // Check if mobile
        function checkMobile() {
            const isMobile = window.innerWidth <= 768;
            const chartWrapper = document.getElementById('chartWrapper');
            const mobileList = document.getElementById('mobileList');
            const btnList = document.getElementById('btnList');
            const btnGantt = document.getElementById('btnGantt');

            if (isMobile) {
                // Default to list view on mobile
                chartWrapper.classList.add('hide-mobile');
                mobileList.classList.add('show-mobile');
                btnList.classList.add('active');
                btnGantt.classList.remove('active');
            } else {
                chartWrapper.classList.remove('hide-mobile');
                mobileList.classList.remove('show-mobile');
            }
        }

        // Event listeners
        document.getElementById('phaseFilter').addEventListener('change', renderAll);
        document.getElementById('roleFilter').addEventListener('change', renderAll);
        document.getElementById('criticalOnly').addEventListener('change', renderAll);
        window.addEventListener('resize', checkMobile);

        // Initial render
        generateQuarterMarkers();
        setupViewToggle();
        checkMobile();
        renderAll();
    </script>
</body>
</html>
